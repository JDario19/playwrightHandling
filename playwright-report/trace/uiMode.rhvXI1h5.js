function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./assets/xtermModule-BeNbaIVa.js","./xtermModule.DSXBckUd.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
var Ht=Object.defineProperty;var Kt=(o,t,e)=>t in o?Ht(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var A=(o,t,e)=>(Kt(o,typeof t!="symbol"?t+"":t,e),e);import{u as $t,r as H,c as qt,_ as Yt,d as Qt,e as Xt,j as r,R as l,E as Gt,s as Tt,f as ct,m as Jt,g as K,T as D,h as Zt,i as te,k as wt,W as ee,M as se,l as _t,n as ie,S as oe,o as St,a as re,b as ne}from"./assets/workbench-DmbIC4jf.js";import{T as ae}from"./assets/testServerConnection-BC33NQsl.js";var le={};class at{constructor(t,e={}){this.isListing=!1,this._tests=new Map,this._rootSuite=new q("","root"),this._options=e,this._reporter=t}reset(){this._rootSuite._entries=[],this._tests.clear()}dispatch(t){const{method:e,params:s}=t;if(e==="onConfigure"){this._onConfigure(s.config);return}if(e==="onProject"){this._onProject(s.project);return}if(e==="onBegin"){this._onBegin();return}if(e==="onTestBegin"){this._onTestBegin(s.testId,s.result);return}if(e==="onTestEnd"){this._onTestEnd(s.test,s.result);return}if(e==="onStepBegin"){this._onStepBegin(s.testId,s.resultId,s.step);return}if(e==="onStepEnd"){this._onStepEnd(s.testId,s.resultId,s.step);return}if(e==="onError"){this._onError(s.error);return}if(e==="onStdIO"){this._onStdIO(s.type,s.testId,s.resultId,s.data,s.isBase64);return}if(e==="onEnd")return this._onEnd(s.result);if(e==="onExit")return this._onExit()}_onConfigure(t){var e,s;this._rootDir=t.rootDir,this._config=this._parseConfig(t),(s=(e=this._reporter).onConfigure)==null||s.call(e,this._config)}_onProject(t){let e=this._options.mergeProjects?this._rootSuite.suites.find(s=>s.project().name===t.name):void 0;e||(e=new q(t.name,"project"),this._rootSuite._addSuite(e)),e._project=this._parseProject(t);for(const s of t.suites)this._mergeSuiteInto(s,e)}_onBegin(){var t,e;(e=(t=this._reporter).onBegin)==null||e.call(t,this._rootSuite)}_onTestBegin(t,e){var c,a;const s=this._tests.get(t);this._options.clearPreviousResultsWhenTestBegins&&(s.results=[]);const i=s._createTestResult(e.id);i.retry=e.retry,i.workerIndex=e.workerIndex,i.parallelIndex=e.parallelIndex,i.setStartTimeNumber(e.startTime),(a=(c=this._reporter).onTestBegin)==null||a.call(c,s,i)}_onTestEnd(t,e){var c,a,m;const s=this._tests.get(t.testId);s.timeout=t.timeout,s.expectedStatus=t.expectedStatus,s.annotations=t.annotations;const i=s.results.find(n=>n._id===e.id);i.duration=e.duration,i.status=e.status,i.errors=e.errors,i.error=(c=i.errors)==null?void 0:c[0],i.attachments=this._parseAttachments(e.attachments),(m=(a=this._reporter).onTestEnd)==null||m.call(a,s,i),i._stepMap=new Map}_onStepBegin(t,e,s){var w,d;const i=this._tests.get(t),c=i.results.find(g=>g._id===e),a=s.parentStepId?c._stepMap.get(s.parentStepId):void 0,m=this._absoluteLocation(s.location),n=new ue(s,a,m);a?a.steps.push(n):c.steps.push(n),c._stepMap.set(s.id,n),(d=(w=this._reporter).onStepBegin)==null||d.call(w,i,c,n)}_onStepEnd(t,e,s){var m,n;const i=this._tests.get(t),c=i.results.find(w=>w._id===e),a=c._stepMap.get(s.id);a.duration=s.duration,a.error=s.error,(n=(m=this._reporter).onStepEnd)==null||n.call(m,i,c,a)}_onError(t){var e,s;(s=(e=this._reporter).onError)==null||s.call(e,t)}_onStdIO(t,e,s,i,c){var w,d,g,T;const a=c?globalThis.Buffer?Buffer.from(i,"base64"):atob(i):i,m=e?this._tests.get(e):void 0,n=m&&s?m.results.find(h=>h._id===s):void 0;t==="stdout"?(n==null||n.stdout.push(a),(d=(w=this._reporter).onStdOut)==null||d.call(w,a,m,n)):(n==null||n.stderr.push(a),(T=(g=this._reporter).onStdErr)==null||T.call(g,a,m,n))}async _onEnd(t){var e,s;await((s=(e=this._reporter).onEnd)==null?void 0:s.call(e,{status:t.status,startTime:new Date(t.startTime),duration:t.duration}))}_onExit(){var t,e;return(e=(t=this._reporter).onExit)==null?void 0:e.call(t)}_parseConfig(t){const e={...he,...t};return this._options.configOverrides&&(e.configFile=this._options.configOverrides.configFile,e.reportSlowTests=this._options.configOverrides.reportSlowTests,e.quiet=this._options.configOverrides.quiet,e.reporter=[...this._options.configOverrides.reporter]),e}_parseProject(t){return{metadata:t.metadata,name:t.name,outputDir:this._absolutePath(t.outputDir),repeatEach:t.repeatEach,retries:t.retries,testDir:this._absolutePath(t.testDir),testIgnore:it(t.testIgnore),testMatch:it(t.testMatch),timeout:t.timeout,grep:it(t.grep),grepInvert:it(t.grepInvert),dependencies:t.dependencies,teardown:t.teardown,snapshotDir:this._absolutePath(t.snapshotDir),use:{}}}_parseAttachments(t){return t.map(e=>({...e,body:e.base64&&globalThis.Buffer?Buffer.from(e.base64,"base64"):void 0}))}_mergeSuiteInto(t,e){let s=e.suites.find(i=>i.title===t.title);s||(s=new q(t.title,e.type==="project"?"file":"describe"),e._addSuite(s)),s.location=this._absoluteLocation(t.location),t.entries.forEach(i=>{"testId"in i?this._mergeTestInto(i,s):this._mergeSuiteInto(i,s)})}_mergeTestInto(t,e){let s=this._options.mergeTestCases?e.tests.find(i=>i.title===t.title&&i.repeatEachIndex===t.repeatEachIndex):void 0;s||(s=new ce(t.testId,t.title,this._absoluteLocation(t.location),t.repeatEachIndex),e._addTest(s),this._tests.set(s.id,s)),this._updateTest(t,s)}_updateTest(t,e){return e.id=t.testId,e.location=this._absoluteLocation(t.location),e.retries=t.retries,e.tags=t.tags??[],e.annotations=t.annotations??[],e}_absoluteLocation(t){return t&&{...t,file:this._absolutePath(t.file)}}_absolutePath(t){if(t!==void 0)return this._options.resolvePath?this._options.resolvePath(this._rootDir,t):this._rootDir+"/"+t}}class q{constructor(t,e){this._entries=[],this._requireFile="",this._parallelMode="none",this.title=t,this._type=e}get type(){return this._type}get suites(){return this._entries.filter(t=>t.type!=="test")}get tests(){return this._entries.filter(t=>t.type==="test")}entries(){return this._entries}allTests(){const t=[],e=s=>{for(const i of s.entries())i.type==="test"?t.push(i):e(i)};return e(this),t}titlePath(){const t=this.parent?this.parent.titlePath():[];return(this.title||this._type!=="describe")&&t.push(this.title),t}project(){var t;return this._project??((t=this.parent)==null?void 0:t.project())}_addTest(t){t.parent=this,this._entries.push(t)}_addSuite(t){t.parent=this,this._entries.push(t)}}class ce{constructor(t,e,s,i){this.fn=()=>{},this.results=[],this.type="test",this.expectedStatus="passed",this.timeout=0,this.annotations=[],this.retries=0,this.tags=[],this.repeatEachIndex=0,this.id=t,this.title=e,this.location=s,this.repeatEachIndex=i}titlePath(){const t=this.parent?this.parent.titlePath():[];return t.push(this.title),t}outcome(){return fe(this)}ok(){const t=this.outcome();return t==="expected"||t==="flaky"||t==="skipped"}_createTestResult(t){const e=new de(this.results.length,t);return this.results.push(e),e}}class ue{constructor(t,e,s){this.duration=-1,this.steps=[],this._startTime=0,this.title=t.title,this.category=t.category,this.location=s,this.parent=e,this._startTime=t.startTime}titlePath(){var e;return[...((e=this.parent)==null?void 0:e.titlePath())||[],this.title]}get startTime(){return new Date(this._startTime)}set startTime(t){this._startTime=+t}}class de{constructor(t,e){this.parallelIndex=-1,this.workerIndex=-1,this.duration=-1,this.stdout=[],this.stderr=[],this.attachments=[],this.status="skipped",this.steps=[],this.errors=[],this._stepMap=new Map,this._startTime=0,this.retry=t,this._id=e}setStartTimeNumber(t){this._startTime=t}get startTime(){return new Date(this._startTime)}set startTime(t){this._startTime=+t}}const he={forbidOnly:!1,fullyParallel:!1,globalSetup:null,globalTeardown:null,globalTimeout:0,grep:/.*/,grepInvert:null,maxFailures:0,metadata:{},preserveOutput:"always",projects:[],reporter:[[le.CI?"dot":"list"]],reportSlowTests:{max:5,threshold:15e3},configFile:"",rootDir:"",quiet:!1,shard:null,updateSnapshots:"missing",version:"",workers:0,webServer:null};function it(o){return o.map(t=>t.s!==void 0?t.s:new RegExp(t.r.source,t.r.flags))}function fe(o){let t=0,e=0,s=0;for(const i of o.results)i.status==="interrupted"||(i.status==="skipped"&&o.expectedStatus==="skipped"?++t:i.status==="skipped"||(i.status===o.expectedStatus?++e:++s));return e===0&&s===0?"skipped":s===0?"expected":e===0&&t===0?"unexpected":"flaky"}class lt{constructor(t,e,s,i,c){this._treeItemById=new Map,this._treeItemByTestId=new Map;const a=i&&[...i.values()].some(Boolean);this.pathSeparator=c,this.rootItem={kind:"group",subKind:"folder",id:t,title:"",location:{file:"",line:0,column:0},duration:0,parent:void 0,children:[],status:"none",hasLoadErrors:!1},this._treeItemById.set(t,this.rootItem);const m=(n,w,d)=>{for(const g of w.suites){const T=g.title||"<anonymous>";let h=d.children.find(f=>f.kind==="group"&&f.title===T);h||(h={kind:"group",subKind:"describe",id:"suite:"+w.titlePath().join("")+""+T,title:T,location:g.location,duration:0,parent:d,children:[],status:"none",hasLoadErrors:!1},this._addChild(d,h)),m(n,g,h)}for(const g of w.tests){const T=g.title;let h=d.children.find(E=>E.kind!=="group"&&E.title===T);h||(h={kind:"case",id:"test:"+g.titlePath().join(""),title:T,parent:d,children:[],tests:[],location:g.location,duration:0,status:"none",project:void 0,test:void 0,tags:g.tags},this._addChild(d,h));const f=g.results[0];let S="none";(f==null?void 0:f[Y])==="scheduled"?S="scheduled":(f==null?void 0:f[Y])==="running"?S="running":(f==null?void 0:f.status)==="skipped"?S="skipped":(f==null?void 0:f.status)==="interrupted"?S="none":f&&g.outcome()!=="expected"?S="failed":f&&g.outcome()==="expected"&&(S="passed"),h.tests.push(g);const B={kind:"test",id:g.id,title:n.name,location:g.location,test:g,parent:h,children:[],status:S,duration:g.results.length?Math.max(0,g.results[0].duration):0,project:n};this._addChild(h,B),this._treeItemByTestId.set(g.id,B),h.duration=h.children.reduce((E,k)=>E+k.duration,0)}};for(const n of(e==null?void 0:e.suites)||[])if(!(a&&!i.get(n.title)))for(const w of n.suites){const d=this._fileItem(w.location.file.split(c),!0);m(n.project(),w,d)}for(const n of s){if(!n.location)continue;const w=this._fileItem(n.location.file.split(c),!0);w.hasLoadErrors=!0}}_addChild(t,e){t.children.push(e),e.parent=t,this._treeItemById.set(e.id,e)}filterTree(t,e,s){const i=t.trim().toLowerCase().split(" "),c=[...e.values()].some(Boolean),a=n=>{const w=[...n.tests[0].titlePath(),...n.tests[0].tags].join(" ").toLowerCase();return!i.every(d=>w.includes(d))&&!n.tests.some(d=>s==null?void 0:s.has(d.id))?!1:(n.children=n.children.filter(d=>!c||(s==null?void 0:s.has(d.test.id))||e.get(d.status)),n.tests=n.children.map(d=>d.test),!!n.children.length)},m=n=>{const w=[];for(const d of n.children)d.kind==="case"?a(d)&&w.push(d):(m(d),(d.children.length||d.hasLoadErrors)&&w.push(d));n.children=w};m(this.rootItem)}_fileItem(t,e){if(t.length===0)return this.rootItem;const s=t.join(this.pathSeparator),i=this._treeItemById.get(s);if(i)return i;const c=this._fileItem(t.slice(0,t.length-1),!1),a={kind:"group",subKind:e?"file":"folder",id:s,title:t[t.length-1],location:{file:s,line:0,column:0},duration:0,parent:c,children:[],status:"none",hasLoadErrors:!1};return this._addChild(c,a),a}sortAndPropagateStatus(){kt(this.rootItem)}flattenForSingleProject(){const t=e=>{e.kind==="case"&&e.children.length===1?(e.project=e.children[0].project,e.test=e.children[0].test,e.children=[],this._treeItemByTestId.set(e.test.id,e)):e.children.forEach(t)};t(this.rootItem)}shortenRoot(){let t=this.rootItem;for(;t.children.length===1&&t.children[0].kind==="group"&&t.children[0].subKind==="folder";)t=t.children[0];t.location=this.rootItem.location,this.rootItem=t}testIds(){const t=new Set,e=s=>{s.kind==="case"&&s.tests.forEach(i=>t.add(i.id)),s.children.forEach(e)};return e(this.rootItem),t}fileNames(){const t=new Set,e=s=>{s.kind==="group"&&s.subKind==="file"?t.add(s.id):s.children.forEach(e)};return e(this.rootItem),[...t]}flatTreeItems(){const t=[],e=s=>{t.push(s),s.children.forEach(e)};return e(this.rootItem),t}treeItemById(t){return this._treeItemById.get(t)}collectTestIds(t){return t?pe(t):new Set}}function kt(o){for(const a of o.children)kt(a);o.kind==="group"&&o.children.sort((a,m)=>a.location.file.localeCompare(m.location.file)||a.location.line-m.location.line);let t=o.children.length>0,e=o.children.length>0,s=!1,i=!1,c=!1;for(const a of o.children)e=e&&a.status==="skipped",t=t&&(a.status==="passed"||a.status==="skipped"),s=s||a.status==="failed",i=i||a.status==="running",c=c||a.status==="scheduled";i?o.status="running":c?o.status="scheduled":s?o.status="failed":e?o.status="skipped":t&&(o.status="passed")}function pe(o){const t=new Set,e=s=>{var i;s.kind==="case"?s.tests.map(c=>c.id).forEach(c=>t.add(c)):s.kind==="test"?t.add(s.id):(i=s.children)==null||i.forEach(e)};return e(o),t}const Y=Symbol("statusEx");class ge{constructor(t){A(this,"rootSuite");A(this,"config");A(this,"loadErrors",[]);A(this,"progress",{total:0,passed:0,failed:0,skipped:0});A(this,"_receiver");A(this,"_lastRunReceiver");A(this,"_lastRunTestCount",0);A(this,"_options");A(this,"_testResultsSnapshot");this._receiver=new at(this._createReporter(),{mergeProjects:!0,mergeTestCases:!0,resolvePath:(e,s)=>e+t.pathSeparator+s,clearPreviousResultsWhenTestBegins:!0}),this._options=t}_createReporter(){return{version:()=>"v2",onConfigure:t=>{this.config=t,this._lastRunReceiver=new at({onBegin:e=>{this._lastRunTestCount=e.allTests().length,this._lastRunReceiver=void 0}},{mergeProjects:!0,mergeTestCases:!1,resolvePath:(e,s)=>e+this._options.pathSeparator+s})},onBegin:t=>{var e;if(this.rootSuite||(this.rootSuite=t),this._testResultsSnapshot){for(const s of this.rootSuite.allTests())s.results=((e=this._testResultsSnapshot)==null?void 0:e.get(s.id))||s.results;this._testResultsSnapshot=void 0}this.progress.total=this._lastRunTestCount,this.progress.passed=0,this.progress.failed=0,this.progress.skipped=0,this._options.onUpdate(!0)},onEnd:()=>{this._options.onUpdate(!0)},onTestBegin:(t,e)=>{e[Y]="running",this._options.onUpdate()},onTestEnd:(t,e)=>{t.outcome()==="skipped"?++this.progress.skipped:t.outcome()==="unexpected"?++this.progress.failed:++this.progress.passed,e[Y]=e.status,this._options.onUpdate()},onError:t=>this._handleOnError(t),printsToStdio:()=>!1,onStdOut:()=>{},onStdErr:()=>{},onExit:()=>{},onStepBegin:()=>{},onStepEnd:()=>{}}}processGlobalReport(t){const e=new at({onConfigure:s=>{this.config=s},onError:s=>this._handleOnError(s)});for(const s of t)e.dispatch(s)}processListReport(t){var s;const e=((s=this.rootSuite)==null?void 0:s.allTests())||[];this._testResultsSnapshot=new Map(e.map(i=>[i.id,i.results])),this._receiver.reset();for(const i of t)this._receiver.dispatch(i)}processTestReportEvent(t){var e,s,i;(s=(e=this._lastRunReceiver)==null?void 0:e.dispatch(t))==null||s.catch(()=>{}),(i=this._receiver.dispatch(t))==null||i.catch(()=>{})}_handleOnError(t){var e,s;this.loadErrors.push(t),(s=(e=this._options).onError)==null||s.call(e,t),this._options.onUpdate()}asModel(){return{rootSuite:this.rootSuite||new q("","root"),config:this.config,loadErrors:this.loadErrors,progress:this.progress}}}const me=({source:o})=>{const[t,e]=$t(),[s,i]=H.useState(qt()),[c]=H.useState(Yt(()=>import("./assets/xtermModule-BeNbaIVa.js"),__vite__mapDeps([0,1]),import.meta.url).then(m=>m.default)),a=H.useRef(null);return H.useEffect(()=>(Qt(i),()=>Xt(i)),[]),H.useEffect(()=>{const m=o.write,n=o.clear;return(async()=>{const{Terminal:w,FitAddon:d}=await c,g=e.current;if(!g)return;const T=s==="dark-mode"?_e:we;if(a.current&&a.current.terminal.options.theme===T)return;a.current&&(g.textContent="");const h=new w({convertEol:!0,fontSize:13,scrollback:1e4,fontFamily:"var(--vscode-editor-font-family)",theme:T}),f=new d;h.loadAddon(f);for(const S of o.pending)h.write(S);o.write=S=>{o.pending.push(S),h.write(S)},o.clear=()=>{o.pending=[],h.clear()},h.open(g),f.fit(),a.current={terminal:h,fitAddon:f}})(),()=>{o.clear=n,o.write=m}},[c,a,e,o,s]),H.useEffect(()=>{setTimeout(()=>{a.current&&(a.current.fitAddon.fit(),o.resize(a.current.terminal.cols,a.current.terminal.rows))},250)},[t,o]),r.jsx("div",{"data-testid":"output",className:"xterm-wrapper",style:{flex:"auto"},ref:e})},we={foreground:"#383a42",background:"#fafafa",cursor:"#383a42",black:"#000000",red:"#e45649",green:"#50a14f",yellow:"#c18401",blue:"#4078f2",magenta:"#a626a4",cyan:"#0184bc",white:"#a0a0a0",brightBlack:"#000000",brightRed:"#e06c75",brightGreen:"#98c379",brightYellow:"#d19a66",brightBlue:"#4078f2",brightMagenta:"#a626a4",brightCyan:"#0184bc",brightWhite:"#383a42",selectionBackground:"#d7d7d7",selectionForeground:"#383a42"},_e={foreground:"#f8f8f2",background:"#1e1e1e",cursor:"#f8f8f0",black:"#000000",red:"#ff5555",green:"#50fa7b",yellow:"#f1fa8c",blue:"#bd93f9",magenta:"#ff79c6",cyan:"#8be9fd",white:"#bfbfbf",brightBlack:"#4d4d4d",brightRed:"#ff6e6e",brightGreen:"#69ff94",brightYellow:"#ffffa5",brightBlue:"#d6acff",brightMagenta:"#ff92df",brightCyan:"#a4ffff",brightWhite:"#e6e6e6",selectionBackground:"#44475a",selectionForeground:"#f8f8f2"},ot=navigator.userAgent.toLowerCase().includes("windows")?"\\":"/",Se=({filterText:o,setFilterText:t,statusFilters:e,setStatusFilters:s,projectFilters:i,setProjectFilters:c,testModel:a,runTests:m})=>{const[n,w]=l.useState(!1),d=l.useRef(null);l.useEffect(()=>{var h;(h=d.current)==null||h.focus()},[]);const g=[...e.entries()].filter(([h,f])=>f).map(([h])=>h).join(" ")||"all",T=[...i.entries()].filter(([h,f])=>f).map(([h])=>h).join(" ")||"all";return r.jsxs("div",{className:"filters",children:[r.jsx(Gt,{expanded:n,setExpanded:w,title:r.jsx("input",{ref:d,type:"search",placeholder:"Filter (e.g. text, @tag)",spellCheck:!1,value:o,onChange:h=>{t(h.target.value)},onKeyDown:h=>{h.key==="Enter"&&m()}})}),r.jsxs("div",{className:"filter-summary",title:"Status: "+g+`
Projects: `+T,onClick:()=>w(!n),children:[r.jsx("span",{className:"filter-label",children:"Status:"})," ",g,r.jsx("span",{className:"filter-label",children:"Projects:"})," ",T]}),n&&r.jsxs("div",{className:"hbox",style:{marginLeft:14,maxHeight:200,overflowY:"auto"},children:[r.jsx("div",{className:"filter-list",children:[...e.entries()].map(([h,f])=>r.jsx("div",{className:"filter-entry",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:f,onClick:()=>{const S=new Map(e);S.set(h,!S.get(h)),s(S)}}),r.jsx("div",{children:h})]})}))}),r.jsx("div",{className:"filter-list",children:[...i.entries()].map(([h,f])=>r.jsx("div",{className:"filter-entry",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:f,onClick:()=>{var E;const S=new Map(i);S.set(h,!S.get(h)),c(S);const B=(E=a==null?void 0:a.config)==null?void 0:E.configFile;B&&Tt.setObject(B+":projects",[...S.entries()].filter(([k,F])=>F).map(([k])=>k))}}),r.jsx("div",{children:h||"untitled"})]})}))})]})]})},ve=({tag:o,style:t,onClick:e})=>r.jsx("span",{className:ct("tag",`tag-color-${xe(o)}`),onClick:e,style:{margin:"6px 0 0 6px",...t},title:`Click to filter by tag: ${o}`,children:o});function xe(o){let t=0;for(let e=0;e<o.length;e++)t=o.charCodeAt(e)+((t<<8)-t);return Math.abs(t%6)}const be=te,Te=({filterText:o,testModel:t,testServerConnection:e,testTree:s,runTests:i,runningState:c,watchAll:a,watchedTreeIds:m,setWatchedTreeIds:n,isLoading:w,onItemSelected:d,requestedCollapseAllCount:g,setFilterText:T,onRevealSource:h})=>{const[f,S]=l.useState({expandedItems:new Map}),[B,E]=l.useState(),[k,F]=l.useState(g);l.useEffect(()=>{if(k!==g){f.expandedItems.clear();for(const x of s.flatTreeItems())f.expandedItems.set(x.id,!1);F(g),E(void 0),S({...f});return}if(!c||c.itemSelectedByUser)return;let u;const y=x=>{var O;x.children.forEach(y),!u&&x.status==="failed"&&(x.kind==="test"&&c.testIds.has(x.test.id)||x.kind==="case"&&c.testIds.has((O=x.tests[0])==null?void 0:O.id))&&(u=x)};y(s.rootItem),u&&E(u.id)},[c,E,s,k,F,g,f,S]);const{selectedTreeItem:N}=l.useMemo(()=>{if(!t)return{selectedTreeItem:void 0};const u=B?s.treeItemById(B):void 0,y=ke(u,t);let x;return(u==null?void 0:u.kind)==="test"?x=u.test:(u==null?void 0:u.kind)==="case"&&u.tests.length===1&&(x=u.tests[0]),d({treeItem:u,testCase:x,testFile:y}),{selectedTreeItem:u}},[d,B,t,s]);l.useEffect(()=>{if(!w)if(a)e==null||e.watchNoReply({fileNames:s.fileNames()});else{const u=new Set;for(const y of m.value){const x=s.treeItemById(y),O=x==null?void 0:x.location.file;O&&u.add(O)}e==null||e.watchNoReply({fileNames:[...u]})}},[w,s,a,m,e]);const Q=u=>{E(u.id),i("bounce-if-busy",s.collectTestIds(u))},$=(u,y)=>{if(u.preventDefault(),u.stopPropagation(),u.metaKey||u.ctrlKey){const x=o.split(" ");x.includes(y)?T(x.filter(O=>O!==y).join(" ").trim()):T((o+" "+y).trim())}else T((o.split(" ").filter(x=>!x.startsWith("@")).join(" ")+" "+y).trim())};return r.jsx(be,{name:"tests",treeState:f,setTreeState:S,rootItem:s.rootItem,dataTestId:"test-tree",render:u=>r.jsxs("div",{className:"hbox ui-mode-list-item",children:[r.jsxs("div",{className:"ui-mode-list-item-title",children:[r.jsx("span",{title:u.title,children:u.title}),u.kind==="case"?u.tags.map(y=>r.jsx(ve,{tag:y.slice(1),onClick:x=>$(x,y)},y)):null]}),!!u.duration&&u.status!=="skipped"&&r.jsx("div",{className:"ui-mode-list-item-time",children:Jt(u.duration)}),r.jsxs(K,{noMinHeight:!0,noShadow:!0,children:[r.jsx(D,{icon:"play",title:"Run",onClick:()=>Q(u),disabled:!!c}),r.jsx(D,{icon:"go-to-file",title:"Show source",onClick:h,style:u.kind==="group"&&u.subKind==="folder"?{visibility:"hidden"}:{}}),!a&&r.jsx(D,{icon:"eye",title:"Watch",onClick:()=>{m.value.has(u.id)?m.value.delete(u.id):m.value.add(u.id),n({...m})},toggled:m.value.has(u.id)})]})]}),icon:u=>Zt(u.status),selectedItem:N,onAccepted:Q,onSelected:u=>{c&&(c.itemSelectedByUser=!0),E(u.id)},isError:u=>u.kind==="group"?u.hasLoadErrors:!1,autoExpandDepth:o?5:1,noItemsMessage:w?"Loading…":"No tests"})};function ke(o,t){if(!(!o||!t))return{file:o.location.file,line:o.location.line,column:o.location.column,source:{errors:t.loadErrors.filter(e=>{var s;return((s=e.location)==null?void 0:s.file)===o.location.file}).map(e=>({line:e.location.line,message:e.message})),content:void 0}}}function je(o){return`.playwright-artifacts-${o}`}const Ee=({item:o,rootDir:t,onOpenExternally:e,revealSource:s})=>{var f;const[i,c]=l.useState(),[a,m]=l.useState(0),n=l.useRef(null),{outputDir:w}=l.useMemo(()=>({outputDir:o.testCase?ye(o.testCase):void 0}),[o]),[d,g]=l.useState(),T=l.useCallback(S=>g(wt(S)),[g]),h=d?i==null?void 0:i.model.actions.find(S=>wt(S)===d):void 0;return l.useEffect(()=>{var k,F;n.current&&clearTimeout(n.current);const S=(k=o.testCase)==null?void 0:k.results[0];if(!S){c(void 0);return}const B=S&&S.duration>=0&&S.attachments.find(N=>N.name==="trace");if(B&&B.path){vt(B.path).then(N=>c({model:N,isLive:!1}));return}if(!w){c(void 0);return}const E=`${w}/${je(S.workerIndex)}/traces/${(F=o.testCase)==null?void 0:F.id}.json`;return n.current=setTimeout(async()=>{try{const N=await vt(E);c({model:N,isLive:!0})}catch{c(void 0)}finally{m(a+1)}},500),()=>{n.current&&clearTimeout(n.current)}},[w,o,c,a,m]),r.jsx(ee,{model:i==null?void 0:i.model,showSourcesFirst:!0,rootDir:t,initialSelection:h,onSelectionChanged:T,fallbackLocation:o.testFile,isLive:i==null?void 0:i.isLive,status:(f=o.treeItem)==null?void 0:f.status,onOpenExternally:e,revealSource:s},"workbench")},ye=o=>{var t;for(let e=o.parent;e;e=e.parent)if(e.project())return(t=e.project())==null?void 0:t.outputDir};async function vt(o){const t=new URLSearchParams;t.set("trace",o);const s=await(await fetch(`contexts?${t.toString()}`)).json();return new se(s)}let xt={cols:80,rows:24};const W={pending:[],clear:()=>{},write:o=>W.pending.push(o),resize:()=>{}},M=new URLSearchParams(window.location.search),Ie=M.get("ws"),jt=new URL(`../${Ie}`,window.location.toString());jt.protocol=window.location.protocol==="https:"?"wss:":"ws:";const j={args:M.getAll("arg"),grep:M.get("grep")||void 0,grepInvert:M.get("grepInvert")||void 0,projects:M.getAll("project"),workers:M.get("workers")||void 0,timeout:M.has("timeout")?+M.get("timeout"):void 0,headed:M.has("headed"),outputDir:M.get("outputDir")||void 0,updateSnapshots:M.get("updateSnapshots")||void 0,reporters:M.has("reporter")?M.getAll("reporter"):void 0};j.updateSnapshots&&!["all","none","missing"].includes(j.updateSnapshots)&&(j.updateSnapshots=void 0);const bt=navigator.platform==="MacIntel",Re=({})=>{var mt;const[o,t]=l.useState(""),[e,s]=l.useState(!1),[i,c]=l.useState(new Map([["passed",!1],["failed",!1],["skipped",!1]])),[a,m]=l.useState(new Map),[n,w]=l.useState(),[d,g]=l.useState(),[T,h]=l.useState({}),[f,S]=l.useState(new Set),[B,E]=l.useState(!1),[k,F]=l.useState(),[N,Q]=_t("watch-all",!1),[$,u]=l.useState({value:new Set}),y=l.useRef(Promise.resolve()),x=l.useRef(new Set),[O,Et]=l.useState(0),[yt,It]=l.useState(!1),[ut,dt]=l.useState(!0),[v,Rt]=l.useState(),[X,Bt]=l.useState(),[G,Ct]=l.useState(!1),[J,Nt]=l.useState(!1),[Pt,ht]=l.useState(!1),Mt=l.useCallback(()=>ht(!0),[ht]),[Z,ft]=l.useState(j.workers),Dt=l.useMemo(()=>[Z==="1",p=>{ft(p?"1":j.workers==="1"?void 0:j.workers)},"Single worker"],[Z,ft]),[tt,pt]=l.useState(j.headed),Lt=l.useMemo(()=>[tt,pt,"Show browser"],[tt,pt]),[et,gt]=l.useState(j.updateSnapshots),Ft=l.useMemo(()=>[et==="all",p=>gt(p?"all":"missing"),"Update snapshots"],[et,gt]),[,,Ot]=_t("show-route-actions",!0,"Show route actions"),At=ie(),Ut=l.useRef(null),st=l.useCallback(()=>{Rt(new ae(jt.toString()))},[]);l.useEffect(()=>{var p;(p=Ut.current)==null||p.focus(),E(!0),st()},[st]),l.useEffect(()=>{if(!v)return;const p=[v.onStdio(_=>{if(_.buffer){const b=atob(_.buffer);W.write(b)}else W.write(_.text)}),v.onClose(()=>It(!0))];return W.resize=(_,b)=>{xt={cols:_,rows:b},v.resizeTerminalNoReply({cols:_,rows:b})},()=>{for(const _ of p)_.dispose()}},[v]),l.useEffect(()=>{if(!v)return;let p;const _=new ge({onUpdate:b=>{clearTimeout(p),p=void 0,b?w(_.asModel()):p||(p=setTimeout(()=>{w(_.asModel())},250))},onError:b=>{W.write((b.stack||b.value||"")+`
`)},pathSeparator:ot});return Bt(_),w(void 0),E(!0),u({value:new Set}),(async()=>{try{await v.initialize({interceptStdio:!0,watchTestDirs:!0});const{status:b,report:I}=await v.runGlobalSetup({});if(_.processGlobalReport(I),b!=="passed")return;const C=await v.listTests({projects:j.projects,locations:j.args,grep:j.grep,grepInvert:j.grepInvert});_.processListReport(C.report),v.onReport(P=>{_.processTestReportEvent(P)});const{hasBrowsers:L}=await v.checkBrowsers({});dt(L)}finally{E(!1)}})(),()=>{clearTimeout(p)}},[v]),l.useEffect(()=>{if(!n)return;const{config:p,rootSuite:_}=n,b=p.configFile?Tt.getObject(p.configFile+":projects",void 0):void 0,I=new Map(a);for(const C of I.keys())_.suites.find(L=>L.title===C)||I.delete(C);for(const C of _.suites)I.has(C.title)||I.set(C.title,!!(b!=null&&b.includes(C.title)));!b&&I.size&&![...I.values()].includes(!0)&&I.set(I.entries().next().value[0],!0),(a.size!==I.size||[...a].some(([C,L])=>I.get(C)!==L))&&m(I)},[a,n]),l.useEffect(()=>{k&&(n!=null&&n.progress)?g(n.progress):n||g(void 0)},[n,k]);const{testTree:Wt}=l.useMemo(()=>{if(!n)return{testTree:new lt("",new q("","root"),[],a,ot)};const p=new lt("",n.rootSuite,n.loadErrors,a,ot);return p.filterTree(o,i,k==null?void 0:k.testIds),p.sortAndPropagateStatus(),p.shortenRoot(),p.flattenForSingleProject(),S(p.testIds()),{testTree:p}},[o,n,i,a,S,k]),z=l.useCallback((p,_)=>{!v||!n||p==="bounce-if-busy"&&k||(x.current=new Set([...x.current,..._]),y.current=y.current.then(async()=>{var C,L,P;const b=x.current;if(x.current=new Set,!b.size)return;{for(const R of((C=n.rootSuite)==null?void 0:C.allTests())||[])if(b.has(R.id)){R.results=[];const U=R._createTestResult("pending");U[Y]="scheduled"}w({...n})}const I="  ["+new Date().toLocaleTimeString()+"]";W.write("\x1B[2m—".repeat(Math.max(0,xt.cols-I.length))+I+"\x1B[22m"),g({total:0,passed:0,failed:0,skipped:0}),F({testIds:b}),await v.runTests({locations:j.args,grep:j.grep,grepInvert:j.grepInvert,testIds:[...b],projects:[...a].filter(([R,U])=>U).map(([R])=>R),workers:Z,timeout:j.timeout,headed:tt,outputDir:j.outputDir,updateSnapshots:et,reporters:j.reporters,trace:"on"});for(const R of((L=n.rootSuite)==null?void 0:L.allTests())||[])((P=R.results[0])==null?void 0:P.duration)===-1&&(R.results=[]);w({...n}),F(void 0)}))},[a,k,n,v,Z,tt,et]);l.useEffect(()=>{if(!v||!X)return;const p=v.onTestFilesChanged(async _=>{if(y.current=y.current.then(async()=>{E(!0);try{const P=await v.listTests({projects:j.projects,locations:j.args,grep:j.grep,grepInvert:j.grepInvert});X.processListReport(P.report)}catch(P){console.log(P)}finally{E(!1)}}),await y.current,_.testFiles.length===0)return;const b=X.asModel(),I=new lt("",b.rootSuite,b.loadErrors,a,ot),C=[],L=new Set(_.testFiles);if(N){const P=R=>{const U=R.location.file;U&&L.has(U)&&C.push(...I.collectTestIds(R)),R.kind==="group"&&R.subKind==="folder"&&R.children.forEach(P)};P(I.rootItem)}else for(const P of $.value){const R=I.treeItemById(P),U=R==null?void 0:R.location.file;U&&L.has(U)&&C.push(...I.collectTestIds(R))}z("queue-if-busy",new Set(C))});return()=>p.dispose()},[z,v,N,$,X,a]),l.useEffect(()=>{if(!v)return;const p=_=>{_.code==="Backquote"&&_.ctrlKey?(_.preventDefault(),s(!e)):_.code==="F5"&&_.shiftKey?(_.preventDefault(),v==null||v.stopTestsNoReply({})):_.code==="F5"&&(_.preventDefault(),z("bounce-if-busy",f))};return addEventListener("keydown",p),()=>{removeEventListener("keydown",p)}},[z,st,v,f,e]);const V=!!k,rt=l.useRef(null),zt=l.useCallback(p=>{var _;p.preventDefault(),p.stopPropagation(),(_=rt.current)==null||_.showModal()},[]),nt=l.useCallback(p=>{var _;p.preventDefault(),p.stopPropagation(),(_=rt.current)==null||_.close()},[]),Vt=l.useCallback(p=>{nt(p),s(!0),v==null||v.installBrowsers({}).then(async()=>{s(!1);const{hasBrowsers:_}=await(v==null?void 0:v.checkBrowsers({}));dt(_)})},[nt,v]);return r.jsxs("div",{className:"vbox ui-mode",children:[!ut&&r.jsxs("dialog",{ref:rt,children:[r.jsxs("div",{className:"title",children:[r.jsx("span",{className:"codicon codicon-lightbulb"}),"Install browsers"]}),r.jsxs("div",{className:"body",children:["Playwright did not find installed browsers.",r.jsx("br",{}),"Would you like to run `playwright install`?",r.jsx("br",{}),r.jsx("button",{className:"button",onClick:Vt,children:"Install"}),r.jsx("button",{className:"button secondary",onClick:nt,children:"Dismiss"})]})]}),yt&&r.jsxs("div",{className:"disconnected",children:[r.jsx("div",{className:"title",children:"UI Mode disconnected"}),r.jsxs("div",{children:[r.jsx("a",{href:"#",onClick:()=>window.location.href="/",children:"Reload the page"})," to reconnect"]})]}),r.jsx(oe,{sidebarSize:250,minSidebarSize:150,orientation:"horizontal",sidebarIsFirst:!0,settingName:"testListSidebar",main:r.jsxs("div",{className:"vbox",children:[r.jsxs("div",{className:ct("vbox",!e&&"hidden"),children:[r.jsxs(K,{children:[r.jsx("div",{className:"section-title",style:{flex:"none"},children:"Output"}),r.jsx(D,{icon:"circle-slash",title:"Clear output",onClick:()=>W.clear()}),r.jsx("div",{className:"spacer"}),r.jsx(D,{icon:"close",title:"Close",onClick:()=>s(!1)})]}),r.jsx(me,{source:W})]}),r.jsx("div",{className:ct("vbox",e&&"hidden"),children:r.jsx(Ee,{item:T,rootDir:(mt=n==null?void 0:n.config)==null?void 0:mt.rootDir,revealSource:Pt,onOpenExternally:p=>v==null?void 0:v.openNoReply({location:{file:p.file,line:p.line,column:p.column}})})})]}),sidebar:r.jsxs("div",{className:"vbox ui-mode-sidebar",children:[r.jsxs(K,{noShadow:!0,noMinHeight:!0,children:[r.jsx("img",{src:"playwright-logo.svg",alt:"Playwright logo"}),r.jsx("div",{className:"section-title",children:"Playwright"}),r.jsx(D,{icon:"refresh",title:"Reload",onClick:()=>st(),disabled:V||B}),r.jsx(D,{icon:"terminal",title:"Toggle output — "+(bt?"⌃`":"Ctrl + `"),toggled:e,onClick:()=>{s(!e)}}),!ut&&r.jsx(D,{icon:"lightbulb-autofix",style:{color:"var(--vscode-list-warningForeground)"},title:"Playwright browsers are missing",onClick:zt})]}),r.jsx(Se,{filterText:o,setFilterText:t,statusFilters:i,setStatusFilters:c,projectFilters:a,setProjectFilters:m,testModel:n,runTests:()=>z("bounce-if-busy",f)}),r.jsxs(K,{noMinHeight:!0,children:[!V&&!d&&r.jsx("div",{className:"section-title",children:"Tests"}),!V&&d&&r.jsx("div",{"data-testid":"status-line",className:"status-line",children:r.jsxs("div",{children:[d.passed,"/",d.total," passed (",d.passed/d.total*100|0,"%)"]})}),V&&d&&r.jsx("div",{"data-testid":"status-line",className:"status-line",children:r.jsxs("div",{children:["Running ",d.passed,"/",k.testIds.size," passed (",d.passed/k.testIds.size*100|0,"%)"]})}),r.jsx(D,{icon:"play",title:"Run all — F5",onClick:()=>z("bounce-if-busy",f),disabled:V||B}),r.jsx(D,{icon:"debug-stop",title:"Stop — "+(bt?"⇧F5":"Shift + F5"),onClick:()=>v==null?void 0:v.stopTests({}),disabled:!V||B}),r.jsx(D,{icon:"eye",title:"Watch all",toggled:N,onClick:()=>{u({value:new Set}),Q(!N)}}),r.jsx(D,{icon:"collapse-all",title:"Collapse all",onClick:()=>{Et(O+1)}})]}),r.jsx(Te,{filterText:o,testModel:n,testTree:Wt,testServerConnection:v,runningState:k,runTests:z,onItemSelected:h,watchAll:N,watchedTreeIds:$,setWatchedTreeIds:u,isLoading:B,requestedCollapseAllCount:O,setFilterText:t,onRevealSource:Mt}),r.jsxs(K,{noShadow:!0,noMinHeight:!0,className:"settings-toolbar",onClick:()=>Nt(!J),children:[r.jsx("span",{className:`codicon codicon-${J?"chevron-down":"chevron-right"}`,style:{marginLeft:5},title:J?"Hide Testing Options":"Show Testing Options"}),r.jsx("div",{className:"section-title",children:"Testing Options"})]}),J&&r.jsx(St,{settings:[Dt,Lt,Ft]}),r.jsxs(K,{noShadow:!0,noMinHeight:!0,className:"settings-toolbar",onClick:()=>Ct(!G),children:[r.jsx("span",{className:`codicon codicon-${G?"chevron-down":"chevron-right"}`,style:{marginLeft:5},title:G?"Hide Settings":"Show Settings"}),r.jsx("div",{className:"section-title",children:"Settings"})]}),G&&r.jsx(St,{settings:[At,Ot]})]})})]})};(async()=>{if(re(),window.location.protocol!=="file:"){if(window.location.href.includes("isUnderTest=true")&&await new Promise(o=>setTimeout(o,1e3)),!navigator.serviceWorker)throw new Error(`Service workers are not supported.
Make sure to serve the website (${window.location}) via HTTPS or localhost.`);navigator.serviceWorker.register("sw.bundle.js"),navigator.serviceWorker.controller||await new Promise(o=>{navigator.serviceWorker.oncontrollerchange=()=>o()}),setInterval(function(){fetch("ping")},1e4)}ne.render(r.jsx(Re,{}),document.querySelector("#root"))})();
